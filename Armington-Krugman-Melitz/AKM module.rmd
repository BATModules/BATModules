---
editor_options: 
  markdown: 
    wrap: 72
---

# **Armington-Krugman-Melitz Module for GTAP v7**

*Modular enhancement of trade analysis with simulation models in GAMS or
GEMPACK developed by David Cui (Wageningen Economic Research)*

## **Objective**

The purposes of creating this module are three-fold: 1) to prepare the
firm heterogeneity model developed by Bekkers & Francois (2018) in a
modular fashion so users can attach this module to a GTAP or GTAP-based
CGE model and switch between Armington, Ethier-Krugman, and Melitz trade
mechanisms as chosen by the user; 2) to update Bekkers & Francois'
original model code and make it compatible with the GTAP v7 model; and
3) to add extra indicators accounting for the productivity of the
representative firm and product quality perceived on the demand side, as
shown in Jafari, Engemann, and Heckelei (2023).

## **Key features of the module**

The module is created based on the firm heterogeneity model developed by
Bekkers & Francois (2018), with their original code being largely
reflected in this module. Users may use the link below to access their
original code: <https://jgea.org/ojs/index.php/jgea/article/view/69>

The main differences between this module and Bekkers & Francois original
code include:

1.  Compared to their original model where the Melitz-related code is
    scattered across the model, this module puts together all the
    related code as a flexible module so that users can conveniently
    attach and switch on/off this module to a GTAP or GTAP-based CGE
    model. The modular feature is also controlled by a handful of
    parameters used to switch on/off the module by setting the
    parameters to a specific value, typically 0 or 1.
2.  This module includes a number of updates compared to their original
    code to reflect the updated GTAP v7 nomenclature and modelling
    approaches. These updates include modified sets, coefficients, and
    variables to make them compatible with GTAP v7 names, and modified
    equations to reflect the new modelling approaches in GTAP v7, for
    example, for the investment goods.
3.  New indicators to capture the productivity of the representative
    firm and product quality perceived on the demand side, derived from
    Jafari et al. (2023) and Dixon et al. (2016), are added in the
    module.

All these updates and the technical details for deriving the new
indicators are detailed in the following sections.

## Module switch on/off

The module is switched on or off by setting the following parameters to
1 or 0. If these parameters are set to 1, the module will be switched
on. In this case, the iceberg trade cost variable, ams, must be set as
an endogenous variable. If these parameters are set to 0, the module
will be switched off. In this case, the iceberg trade cost variable,
ams, must be set as an exogenous variable.

Coefficient (parameter) (all,c,COMM) AKMCOMM(c);

Formula(initial) (all,c,COMM) AKMCOMM(c) = 1;

Read (IfHeaderExists) AKMCOMM from file GTAPPARM header "AKMC";

Set AKM_COMM \# AKM-Melitz commodities \# = (all,c,COMM:AKMCOMM(c)=1);

Set NAKM_COMM = COMM - AKM_COMM;

Coefficient (parameter) (all,r,REG) AKMREG(r);

Formula(initial) (all,r,REG) AKMREG(r) = 1;

Read (IfHeaderExists) AKMREG from file GTAPPARM header "AKMR";

Set AKM_REG \# AKM-Melitz regions \# = (all,r,REG:AKMREG(r)=1);

Set NAKM_REG = REG - AKM_REG;

## Modified sets, coefficients, and variables

Note: all the modified module-specific sets, coefficients, and variables
are prefixed with "AKM\_" while the modified GTAP sets, coefficients,
and variables keep their existing GTAP names.

*Table: Modified GTAP sets*

| Index     | Old Set   | Description        | GAMS | GEMPACK |
|-----------|-----------|--------------------|------|---------|
| *i, c*    | TRAD_COMM | traded commodities |      | COMM    |
| *r, s, d* | REG       | regions            |      | REG     |
| *j*       | PROD_COMM | activities         |      | ACTS    |
| *m*       | MARG_COMM | margin commodities |      | MARG    |

*Table: Modified GTAP and module-specific coefficients*

| Old Coefficient | Description                                                          | GAMS | GEMPACK       |
|-----------------|--------------------|-----------------|-----------------|
| ESUBM(i)        | elasticity of substitution in imports between different regions      |      | AKM_ESUBM(i)  |
| ESUBD(i)        | elasticity of substitution between domestic and imported commodities |      | AKM_ESUBD(i)  |
| VOM(i,r)        | value of commodity i output in region r at market (basic) prices     |      | VCB(i,r)      |
| SHRIPM(i,r)     | share of import i used by private hhlds in r                         |      | PMCSHR(i,r)   |
| SHRIGM(i,r)     | share of import i used by government in r                            |      | GMCSHR(i,r)   |
| \-\--           | share of import i used by investors in r                             |      | IMCSHR(i,r)   |
| SHRIFM(i,j,r)   | share of import i used by activity j in r                            |      | FMCSHR(i,j,r) |
| SHRDPM(i,r)     | share of domestic i used by private hhlds in r                       |      | PDCSHR(i,r)   |
| SHRDGM(i,r)     | share of domestic i used by government in r                          |      | GDCSHR(i,r)   |
| \-\--           | share of domestic i used by investors in r                           |      | IDCSHR(i,r)   |
| SHRDFM(i,j,r)   | share of domestic i used by activity j in r                          |      | FDCSHR(i,j,r) |
| VXMD(c,s,d)     | exports of i from s to d valued at market (basic) prices             |      | VXSB(c,s,d)   |
| VIMS(c,s,d)     | value of imports of c from s to d at domestic (basic) prices         |      | VMSB(c,s,d)   |
| VDM(i,r)        | domestic sales of c in r at market (basic) prices                    |      | VDB(i,r)      |

*Table: Modified GTAP variables*

| Old Variable | Description                                                | GAMS | GEMPACK     |
|-----------------|--------------------|-----------------|-----------------|
| qo(i,r)      | output of commodity i in region r                          |      | qc(i,r)     |
| pm(i,r)      | basic price of commodity i in region r                     |      | pds(i,r)    |
| pp(i,r)      | private consumption price for commodity c in region r      |      | ppa(i,r)    |
| qp(i,r)      | private hhld demand for commodity c in region r            |      | qpa(i,r)    |
| pg(i,r)      | government consumption price for commodity c in region r   |      | pga(i,r)    |
| qg(i,r)      | government demand for commodity c in region r              |      | qga(i,r)    |
| \-\--        | price of investment commodity in region r                  |      | pia(i,r)    |
| \-\--        | demand for investment commodity c in region r              |      | qia(i,r)    |
| pf(i,j,r)    | firms' price for commodity c for use by act. a in r        |      | pfa(i,j,r)  |
| qf(i,j,r)    | demand for commodity c for use by act. a in region r       |      | qfa(i,j,r)  |
| pms(c,s,d)   | price of imported c supplied by source region s to dest. d |      | pmds(c,s,d) |

## Modified existing equations

1.  The equations accounting for the value of regional demand are
    modified to reflect the new approach to modelling investment goods
    in GTAP v7.

In Bekkers & Francois (2018), the original code for these equations is
written as:

EQUATION VREGDEMANDm \# change in value of regional demand for commodity
i \#

(all,i,TRAD_COMM)(all,r,REG)

valueDm(i,r) = SHRIPM(i,r)\*[pp(i,r) + qp(i,r)] +
SHRIGM(i,r)\*[pg(i,r) + qg(i,r)] + sum(j,PROD_COMM, (SHRIFM(i,j,r) \*
[pf(i,j,r) + qf(i,j,r)]));

EQUATION VREGDEMANDd \# change in value of regional demand for commodity
i \#

(all,i,TRAD_COMM)(all,r,REG)

valueDd(i,r) = SHRDPM(i,r)\*[pp(i,r) + qp(i,r)] +
SHRDGM(i,r)\*[pg(i,r) + qg(i,r)] + sum(j,PROD_COMM, (SHRDFM(i,j,r) \*
[pf(i,j,r) + qf(i,j,r)]));

In this v7 module, these equations are modified as:

EQUATION VREGDEMANDm \# change in value of regional demand for commodity
i \#

(all,i,COMM) (all,r,REG)

valueDm(i,r) = PMCSHR(i,r)\*[ppa(i,r) + qpa(i,r)] +
GMCSHR(i,r)\*[pga(i,r) + qga(i,r)] + IMCSHR(i,r)\*[pia(i,r) +
qia(i,r)] + sum(j,ACTS, (FMCSHR(i,j,r) \* [pfa(i,j,r) + qfa(i,j,r)]));

EQUATION VREGDEMANDd \# change in value of regional demand for commodity
i \#

(all,i,COMM)(all,r,REG)

valueDd(i,r) = PDCSHR(i,r)\*[ppa(i,r) + qpa(i,r)] +
GDCSHR(i,r)\*[pga(i,r) + qga(i,r)] + IDCSHR(i,r)\*[pia(i,r) +
qia(i,r)] + sum(j,ACTS, (FDCSHR(i,j,r) \* [pfa(i,j,r) + qfa(i,j,r)]));

2.  The equation to decompose Equivalent Variation is modified to
    reflect the new definition in GTAP v7 for an EV component

Equation EV_DECOMP_partsw (all,r,REG) \# decomposition of Equivalent
Variation from parts with N and psi \#

The original equation in Bekkers & Francois (2018) is written as

EV_ALT_partsw(r) = CNTdpar(r) + CNTalleffr(r) + CNTendwr(r) +
CNTtotr(r) + CNTtechr_pure(r) + CNTcgdsr(r) + CNT_tc(r) + CNT_psii(r) +
CNT_psid(r) + CNT_nvi(r) + CNT_nvd(r) + CNT_M(r);

In this v7 module, the above equation is changed to:

EV_ALT_partsw(r) = CNTdpar(r) + sum(t,CTAX,CNTalleffr(r,t)) +
CNTendwr(r) + CNTtotr(r) + CNTtechr_pure(r) + CNTcgdsr(r) + CNT_tc(r) +
CNT_psii(r) + CNT_psid(r) + CNT_nvi(r) + CNT_nvd(r) + CNT_M(r);

## Added indicators and equations

In this v7 module, new indicators are added to capture the productivity
of the representative firm and product quality perceived on the demand
side. As shown below, these indicators are derived from Jafari et al.
(2023) and Dixon et al. (2016).

In Jafari et al. (2023), the productivity of the representative firm
participating in international trade on a S-D link in the Melitz
framework (Melitz, 2003) is given by

$$
𝜑̃_{𝑖𝑠𝑑} = 𝑏(𝑎/(𝑎 +1− 𝜎_{𝑖𝑑}))^{1/(𝜎_{𝑖𝑑}−1)}(𝑁_{𝑖𝑠𝑑}/𝑀_{𝑖𝑠})^{−1/𝑎}
$$

where N is the number of all participating firms traded on the S-D link
and M is the number of all incumbent firms in region s. While a, b, and
𝞼 are parameters given in the model, both variables are endogenous in
the model and thus need to be solved. Jafari et al. (2023) however does
not provide an explicit solution to these variables. The relationship
between these variables, however, has been determined in equation T2.8
in Dixon et al. (2016), which states

$$N_{sd}=N_s*𝚽^{-a}_{(min)sd}$$

where 𝚽min denotes the cutoff productivity operating on the S-D link.
While this equation is applied to only one industry in Dixon et al.'s
model, this equation can also be generalized and applied to other
industries. Thus, this equation allows us to simplify the above Jafari
et al.'s productivity equation as:

$$
𝜑̃_{𝑖𝑠𝑑} = 𝑏(𝑎/(𝑎 +1− 𝜎_{𝑖𝑑}))^{1/(𝜎_{𝑖𝑑}−1)}𝚽_{(min)isd}
$$

This simplified equation shows that the productivity of the
representative firm operating on a S-D link is proportional to the
cutoff productivity operating on the same S-D link.

Given the productivity of the representative firm, its product quality
perceived by consumers on the demand side in Jafari et al. (2023) is
given by

$$
𝜆̃_{𝑖𝑠𝑑} = 𝜑̃^𝝍_{𝑖𝑠𝑑}
$$

where 𝛙 is a parameter controlling the conversion from the
representative firm's productivity to its product quality.

In GEMPACK, we implement the above simplified equation that determines
the productivity of the representative firm as

Equation E_phi (all,i,COMM)(all,s,REG)(all,d,REG)

phi(i,s,d) = psistar(i,s,d);

where phi stands for the percentage change of the representative firm's
productivity and psistar is the percentage change of the cutoff
productivity. As can be seen, this equation essentially shows that the
productivity of the representative firm moves in line with the cutoff
productivity on the same trade link.

Likewise, the equation to determine the representative firm's product
quality is coded in GEMPACK as:

Equation E_lamda (all,i,COMM)(all,s,REG)(all,d,REG)

lamda(i,s,d) = psi \* phi(i,s,d);

where lamda represents the product quality of the representative firm
perceived by consumers and psi is the parameter converting the
representative firm's productivity to its product quality.

## References

Bekkers, E., & Francois, J. (2018). A parsimonious approach to
incorporate firm heterogeneity in CGE-models. *Journal of Global
Economic Analysis*, 3(2), 1-68.

Dixon, P., Jerie, M., & Rimmer, M. (2016). Modern trade theory for CGE
modelling: the Armington, Krugman and Melitz models. *Journal of Global
Economic Analysis*, 1(1), 1-110.

Jafari, Y., Engemann, H., & Heckelei, T. (2023). A Computable General
Equilibrium Theory of Heterogeneous Firms with Product Quality
Differentiation. BATModel Deliverable D3.1.

Melitz, M. J. (2003). The impact of trade on intra‐industry
reallocations and aggregate industry
productivity. *Econometrica*, *71*(6), 1695-1725.
